#!/usr/bin/env python3
import asyncio
import aiohttp
from datetime import datetime
from calendar import monthcalendar
import logging
import random
import sys
import os

logging.basicConfig(level=logging.INFO, format='%(asctime)s - %(levelname)s - %(message)s')
logger = logging.getLogger(__name__)

class FamilyScheduleBot:
    # –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã –∫–ª–∞—Å—Å–∞
    DAY_NAMES_MAP = {
        'monday': '–ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫',
        'tuesday': '–≤—Ç–æ—Ä–Ω–∏–∫', 
        'wednesday': '—Å—Ä–µ–¥–∞',
        'thursday': '—á–µ—Ç–≤–µ—Ä–≥',
        'friday': '–ø—è—Ç–Ω–∏—Ü–∞',
        'saturday': '—Å—É–±–±–æ—Ç–∞',
        'sunday': '–≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ'
    }
    
    def __init__(self):
        self.telegram_token = os.getenv('TELEGRAM_TOKEN', '')
        if not self.telegram_token:
            raise ValueError("‚ùå TELEGRAM_TOKEN –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è!")
        
        self.chat_id = os.getenv('TELEGRAM_CHAT_ID', '')
        if not self.chat_id:
            raise ValueError("‚ùå TELEGRAM_CHAT_ID –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è!")
        
        self.ss_url = "https://brkme.github.io/OK_My_Day_Shedule/ss.html"
        
        self.wisdoms = [
            "–ü—É—Å—Ç—å —Å–µ–≥–æ–¥–Ω—è—à–Ω–∏–π –¥–µ–Ω—å –ø—Ä–∏–Ω–µ—Å—ë—Ç –º–Ω–æ–≥–æ —É–ª—ã–±–æ–∫ –∏ –ø—Ä–∏—è—Ç–Ω—ã—Ö –º–æ–º–µ–Ω—Ç–æ–≤",
            "–•–æ—Ä–æ—à–µ–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ ‚Äî –ª—É—á—à–∏–π —Å—Ç–∞—Ä—Ç –¥–ª—è –ª—é–±–æ–≥–æ –¥–Ω—è",
            "–ü—É—Å—Ç—å —ç—Ç–æ—Ç –¥–µ–Ω—å –±—É–¥–µ—Ç –Ω–∞–ø–æ–ª–Ω–µ–Ω —Ç–µ–ø–ª–æ–º –∏ —Ä–∞–¥–æ—Å—Ç—å—é",
            "–°–µ–≥–æ–¥–Ω—è –æ—Ç–ª–∏—á–Ω—ã–π –¥–µ–Ω—å, —á—Ç–æ–±—ã –±—ã—Ç—å —Å—á–∞—Å—Ç–ª–∏–≤—ã–º",
            "–ü—É—Å—Ç—å –∫–∞–∂–¥—ã–π –º–æ–º–µ–Ω—Ç —Å–µ–≥–æ–¥–Ω—è –±—É–¥–µ—Ç –æ—Å–æ–±–µ–Ω–Ω—ã–º",
            "–î–æ–±—Ä–æ–µ —É—Ç—Ä–æ! –ü—É—Å—Ç—å –¥–µ–Ω—å –ø—Ä–∏–Ω–µ—Å—ë—Ç —á—Ç–æ-—Ç–æ —Ö–æ—Ä–æ—à–µ–µ",
            "–ü—É—Å—Ç—å —Å–µ–≥–æ–¥–Ω—è –≤—Å—ë –ø–æ–ª—É—á–∏—Ç—Å—è –ª–µ–≥–∫–æ –∏ —Å —É–¥–æ–≤–æ–ª—å—Å—Ç–≤–∏–µ–º",
            "–ñ–µ–ª–∞—é —Ç–µ–±–µ —Å–µ–≥–æ–¥–Ω—è –±–æ–ª—å—à–µ –ø–æ–≤–æ–¥–æ–≤ –¥–ª—è —É–ª—ã–±–∫–∏",
            "–ü—É—Å—Ç—å —ç—Ç–æ—Ç –¥–µ–Ω—å –±—É–¥–µ—Ç –¥–æ–±—Ä—ã–º –∏ —Å–≤–µ—Ç–ª—ã–º",
            "–°–µ–≥–æ–¥–Ω—è ‚Äî –ø—Ä–µ–∫—Ä–∞—Å–Ω—ã–π –¥–µ–Ω—å –¥–ª—è –º–∞–ª–µ–Ω—å–∫–∏—Ö —Ä–∞–¥–æ—Å—Ç–µ–π",
            "–ü—É—Å—Ç—å –≤—Å—ë –∑–∞–¥—É–º–∞–Ω–Ω–æ–µ —Å–µ–≥–æ–¥–Ω—è —Å–±—É–¥–µ—Ç—Å—è",
            "–ñ–µ–ª–∞—é —Ç–µ–±–µ —Å–µ–≥–æ–¥–Ω—è –≤—Å—Ç—Ä–µ—Ç–∏—Ç—å —á—Ç–æ-—Ç–æ –ø—Ä–∏—è—Ç–Ω–æ–µ",
            "–ü—É—Å—Ç—å –¥–µ–Ω—å –ø—Ä–æ–π–¥—ë—Ç –≤ –≥–∞—Ä–º–æ–Ω–∏–∏ –∏ —Å–ø–æ–∫–æ–π—Å—Ç–≤–∏–∏",
            "–°–µ–≥–æ–¥–Ω—è –≤—Å—ë –±—É–¥–µ—Ç —Ö–æ—Ä–æ—à–æ, –ø—Ä–æ—Å—Ç–æ –ø–æ–≤–µ—Ä—å –≤ —ç—Ç–æ",
            "–ü—É—Å—Ç—å —ç—Ç–æ—Ç –¥–µ–Ω—å –ø–æ–¥–∞—Ä–∏—Ç —Ç–µ–±–µ –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏–µ",
            "–ñ–µ–ª–∞—é —Ç–µ–±–µ —Å–µ–≥–æ–¥–Ω—è –Ω–∞–π—Ç–∏ –ø–æ–≤–æ–¥ –¥–ª—è —Ä–∞–¥–æ—Å—Ç–∏",
            "–ü—É—Å—Ç—å –∫–∞–∂–¥—ã–π —á–∞—Å —Å–µ–≥–æ–¥–Ω—è –ø—Ä–∏–Ω–µ—Å—ë—Ç —á—Ç–æ-—Ç–æ –¥–æ–±—Ä–æ–µ",
            "–°–µ–≥–æ–¥–Ω—è ‚Äî –¥–µ–Ω—å –¥–ª—è –Ω–æ–≤—ã—Ö –æ—Ç–∫—Ä—ã—Ç–∏–π –∏ —É–ª—ã–±–æ–∫",
            "–ü—É—Å—Ç—å –≤—Å—ë —Å–µ–≥–æ–¥–Ω—è —Å–∫–ª–∞–¥—ã–≤–∞–µ—Ç—Å—è –≤ —Ç–≤–æ—é –ø–æ–ª—å–∑—É",
            "–ñ–µ–ª–∞—é —Ç–µ–±–µ —Å–µ–≥–æ–¥–Ω—è —á—É–≤—Å—Ç–≤–æ–≤–∞—Ç—å —Å–µ–±—è –Ω–∞ –≤—ã—Å–æ—Ç–µ",
            "–ü—É—Å—Ç—å —ç—Ç–æ—Ç –¥–µ–Ω—å –±—É–¥–µ—Ç –ø–æ–ª–æ–Ω –ø—Ä–∏—è—Ç–Ω—ã—Ö —Å—é—Ä–ø—Ä–∏–∑–æ–≤",
            "–°–µ–≥–æ–¥–Ω—è ‚Äî –æ—Ç–ª–∏—á–Ω—ã–π –¥–µ–Ω—å, —á—Ç–æ–±—ã –Ω–∞—Å–ª–∞–¥–∏—Ç—å—Å—è –∂–∏–∑–Ω—å—é",
            "–ü—É—Å—Ç—å –≤—Å—ë –ø–æ–ª—É—á–∏—Ç—Å—è —Ç–∞–∫, –∫–∞–∫ —Ç—ã —Ö–æ—á–µ—à—å",
            "–ñ–µ–ª–∞—é —Ç–µ–±–µ —Å–µ–≥–æ–¥–Ω—è –±–æ–ª—å—à–µ —ç–Ω–µ—Ä–≥–∏–∏ –∏ –º–µ–Ω—å—à–µ –∑–∞–±–æ—Ç",
            "–ü—É—Å—Ç—å –¥–µ–Ω—å –ø—Ä–∏–Ω–µ—Å—ë—Ç —Ç–µ–±–µ –ø–æ–∫–æ–π –∏ —Ä–∞–¥–æ—Å—Ç—å",
            "–°–µ–≥–æ–¥–Ω—è –≤—Å—ë –±—É–¥–µ—Ç –∏–º–µ–Ω–Ω–æ —Ç–∞–∫, –∫–∞–∫ –Ω—É–∂–Ω–æ",
            "–ü—É—Å—Ç—å —ç—Ç–æ—Ç –¥–µ–Ω—å —Å—Ç–∞–Ω–µ—Ç –Ω–∞—á–∞–ª–æ–º —á–µ–≥–æ-—Ç–æ —Ö–æ—Ä–æ—à–µ–≥–æ",
            "–ñ–µ–ª–∞—é —Ç–µ–±–µ —Å–µ–≥–æ–¥–Ω—è –ª—ë–≥–∫–æ—Å—Ç–∏ –≤–æ –≤—Å—ë–º",
            "–ü—É—Å—Ç—å –∫–∞–∂–¥–∞—è –º–∏–Ω—É—Ç–∞ —Å–µ–≥–æ–¥–Ω—è –±—É–¥–µ—Ç –ø—Ä–∏—è—Ç–Ω–æ–π",
            "–°–µ–≥–æ–¥–Ω—è ‚Äî –¥–µ–Ω—å –¥–ª—è —Ö–æ—Ä–æ—à–∏—Ö –Ω–æ–≤–æ—Å—Ç–µ–π",
            "–ü—É—Å—Ç—å –≤—Å—ë —Å–µ–≥–æ–¥–Ω—è –∏–¥—ë—Ç —Å–≤–æ–∏–º —á–µ—Ä–µ–¥–æ–º –∏ –ª–µ–≥–∫–æ",
            "–ñ–µ–ª–∞—é —Ç–µ–±–µ —Å–µ–≥–æ–¥–Ω—è –≤—Å—Ç—Ä–µ—Ç–∏—Ç—å –¥–æ–±—Ä—ã—Ö –ª—é–¥–µ–π",
            "–ü—É—Å—Ç—å —ç—Ç–æ—Ç –¥–µ–Ω—å –±—É–¥–µ—Ç –Ω–∞–ø–æ–ª–Ω–µ–Ω —Å–º—ã—Å–ª–æ–º",
            "–°–µ–≥–æ–¥–Ω—è ‚Äî –ø—Ä–µ–∫—Ä–∞—Å–Ω–æ–µ –≤—Ä–µ–º—è –¥–ª—è —Å—á–∞—Å—Ç—å—è",
            "–ü—É—Å—Ç—å –≤—Å—ë —Å–µ–≥–æ–¥–Ω—è –ø–æ–ª—É—á–∞–µ—Ç—Å—è —Å –ø–µ—Ä–≤–æ–≥–æ —Ä–∞–∑–∞",
            "–ñ–µ–ª–∞—é —Ç–µ–±–µ —Å–µ–≥–æ–¥–Ω—è —Å–∏–ª –∏ —Ö–æ—Ä–æ—à–µ–≥–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è",
            "–ü—É—Å—Ç—å –¥–µ–Ω—å –ø–æ–¥–∞—Ä–∏—Ç —Ç–µ–±–µ —Ç–µ–ø–ª–æ –∏ —É—é—Ç",
            "–°–µ–≥–æ–¥–Ω—è –≤—Å—ë –∫ –ª—É—á—à–µ–º—É, —Ç–∞–∫ –∏ –∑–Ω–∞–π",
            "–ü—É—Å—Ç—å —ç—Ç–æ—Ç –¥–µ–Ω—å –±—É–¥–µ—Ç —â–µ–¥—Ä—ã–º –Ω–∞ —Ä–∞–¥–æ—Å—Ç—å",
            "–ñ–µ–ª–∞—é —Ç–µ–±–µ —Å–µ–≥–æ–¥–Ω—è –Ω–∞–π—Ç–∏ –≤—Ä–µ–º—è –¥–ª—è —Å–µ–±—è",
            "–ü—É—Å—Ç—å –≤—Å—ë —Å–µ–≥–æ–¥–Ω—è —Å–∫–ª–∞–¥—ã–≤–∞–µ—Ç—Å—è —É–¥–∞—á–Ω–æ",
            "–°–µ–≥–æ–¥–Ω—è ‚Äî –¥–µ–Ω—å –¥–ª—è –¥–æ–±—Ä—ã—Ö –¥–µ–ª –∏ —Å–≤–µ—Ç–ª—ã—Ö –º—ã—Å–ª–µ–π",
            "–ü—É—Å—Ç—å –∫–∞–∂–¥—ã–π —à–∞–≥ —Å–µ–≥–æ–¥–Ω—è –±—É–¥–µ—Ç –ª—ë–≥–∫–∏–º",
            "–ñ–µ–ª–∞—é —Ç–µ–±–µ —Å–µ–≥–æ–¥–Ω—è —á—É–≤—Å—Ç–≤–æ–≤–∞—Ç—å —Å–µ–±—è –ø—Ä–µ–∫—Ä–∞—Å–Ω–æ",
            "–ü—É—Å—Ç—å —ç—Ç–æ—Ç –¥–µ–Ω—å –ø—Ä–∏–Ω–µ—Å—ë—Ç –º–∏—Ä –≤ –¥—É—à–µ",
            "–°–µ–≥–æ–¥–Ω—è –≤—Å—ë –ø–æ–ª—É—á–∏—Ç—Å—è, –≥–ª–∞–≤–Ω–æ–µ ‚Äî –Ω–∞—á–∞—Ç—å",
            "–ü—É—Å—Ç—å –¥–µ–Ω—å –±—É–¥–µ—Ç –¥–æ–±—Ä—ã–º –∫ —Ç–µ–±–µ –∏ –±–ª–∏–∑–∫–∏–º",
            "–ñ–µ–ª–∞—é —Ç–µ–±–µ —Å–µ–≥–æ–¥–Ω—è –ø–æ–∑–∏—Ç–∏–≤–Ω—ã—Ö —ç–º–æ—Ü–∏–π",
            "–ü—É—Å—Ç—å –≤—Å—ë —Å–µ–≥–æ–¥–Ω—è —Ä–∞–¥—É–µ—Ç –∏ –≤–¥–æ—Ö–Ω–æ–≤–ª—è–µ—Ç",
            "–°–µ–≥–æ–¥–Ω—è ‚Äî –æ—Ç–ª–∏—á–Ω—ã–π –¥–µ–Ω—å –¥–ª—è —É–ª—ã–±–æ–∫",
            "–ü—É—Å—Ç—å —ç—Ç–æ—Ç –¥–µ–Ω—å –±—É–¥–µ—Ç –ø–æ–ª–æ–Ω —Å–≤–µ—Ç–∞",
            "–ñ–µ–ª–∞—é —Ç–µ–±–µ —Å–µ–≥–æ–¥–Ω—è –≤—Å—Ç—Ä–µ—Ç–∏—Ç—å —á—Ç–æ-—Ç–æ –∫—Ä–∞—Å–∏–≤–æ–µ",
            "–ü—É—Å—Ç—å –≤—Å—ë —Å–µ–≥–æ–¥–Ω—è –∏–¥—ë—Ç –ø–æ –ø–ª–∞–Ω—É –∏ –¥–∞–∂–µ –ª—É—á—à–µ",
            "–°–µ–≥–æ–¥–Ω—è ‚Äî –¥–µ–Ω—å –¥–ª—è –ø—Ä–∏—è—Ç–Ω—ã—Ö –æ—Ç–∫—Ä—ã—Ç–∏–π",
            "–ü—É—Å—Ç—å –∫–∞–∂–¥–æ–µ –º–≥–Ω–æ–≤–µ–Ω–∏–µ —Å–µ–≥–æ–¥–Ω—è –±—É–¥–µ—Ç —Ü–µ–Ω–Ω—ã–º",
            "–ñ–µ–ª–∞—é —Ç–µ–±–µ —Å–µ–≥–æ–¥–Ω—è –±–æ–ª—å—à–µ —Ç–µ–ø–ª–∞ –∏ –º–µ–Ω—å—à–µ —Å—Ç—Ä–µ—Å—Å–∞",
            "–ü—É—Å—Ç—å —ç—Ç–æ—Ç –¥–µ–Ω—å –±—É–¥–µ—Ç –≥–∞—Ä–º–æ–Ω–∏—á–Ω—ã–º",
            "–°–µ–≥–æ–¥–Ω—è –≤—Å—ë —Å–ª–æ–∂–∏—Ç—Å—è –∫–∞–∫ –Ω–∞–¥–æ",
            "–ü—É—Å—Ç—å –¥–µ–Ω—å –ø—Ä–∏–Ω–µ—Å—ë—Ç —Ç–µ–±–µ –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏–µ –∏ —Å–∏–ª—ã",
            "–ñ–µ–ª–∞—é —Ç–µ–±–µ —Å–µ–≥–æ–¥–Ω—è —Ä–∞–¥–æ–≤–∞—Ç—å—Å—è –º–µ–ª–æ—á–∞–º",
            "–ü—É—Å—Ç—å –≤—Å—ë —Å–µ–≥–æ–¥–Ω—è –ø–æ–ª—É—á–∞–µ—Ç—Å—è –ª–µ–≥–∫–æ –∏ –ø—Ä–∏—è—Ç–Ω–æ",
            "–°–µ–≥–æ–¥–Ω—è ‚Äî –ø—Ä–µ–∫—Ä–∞—Å–Ω—ã–π –¥–µ–Ω—å –¥–ª—è –±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–∏",
            "–ü—É—Å—Ç—å —ç—Ç–æ—Ç –¥–µ–Ω—å –±—É–¥–µ—Ç –¥–æ–±—Ä—ã–º –Ω–∞—á–∞–ª–æ–º",
            "–ñ–µ–ª–∞—é —Ç–µ–±–µ —Å–µ–≥–æ–¥–Ω—è —è—Å–Ω–æ—Å—Ç–∏ –∏ —Å–ø–æ–∫–æ–π—Å—Ç–≤–∏—è",
            "–ü—É—Å—Ç—å –≤—Å—ë —Å–µ–≥–æ–¥–Ω—è –ø—Ä–∏–Ω–æ—Å–∏—Ç —É–¥–æ–≤–æ–ª—å—Å—Ç–≤–∏–µ",
            "–°–µ–≥–æ–¥–Ω—è ‚Äî –¥–µ–Ω—å –¥–ª—è —Ö–æ—Ä–æ—à–∏—Ö —ç–º–æ—Ü–∏–π",
            "–ü—É—Å—Ç—å –∫–∞–∂–¥—ã–π —á–∞—Å —Å–µ–≥–æ–¥–Ω—è –±—É–¥–µ—Ç –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ã–º",
            "–ñ–µ–ª–∞—é —Ç–µ–±–µ —Å–µ–≥–æ–¥–Ω—è –≤—Å—Ç—Ä–µ—Ç–∏—Ç—å –∫—Ä–∞—Å–æ—Ç—É –≤–æ–∫—Ä—É–≥",
            "–ü—É—Å—Ç—å —ç—Ç–æ—Ç –¥–µ–Ω—å –±—É–¥–µ—Ç –Ω–∞–ø–æ–ª–Ω–µ–Ω –¥–æ–±—Ä–æ—Ç–æ–π",
            "–°–µ–≥–æ–¥–Ω—è –≤—Å—ë –∏–¥—ë—Ç —Å–≤–æ–∏–º —á–µ—Ä–µ–¥–æ–º –∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ",
            "–ü—É—Å—Ç—å –¥–µ–Ω—å –ø–æ–¥–∞—Ä–∏—Ç —Ç–µ–±–µ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å",
            "–ñ–µ–ª–∞—é —Ç–µ–±–µ —Å–µ–≥–æ–¥–Ω—è –±–æ–ª—å—à–µ —Ä–∞–¥–æ—Å—Ç–∏",
            "–ü—É—Å—Ç—å –≤—Å—ë —Å–µ–≥–æ–¥–Ω—è —Ä–∞–¥—É–µ—Ç –≥–ª–∞–∑ –∏ –¥—É—à—É",
            "–°–µ–≥–æ–¥–Ω—è ‚Äî –æ—Ç–ª–∏—á–Ω—ã–π –¥–µ–Ω—å –¥–ª—è –ø–æ–±–µ–¥",
            "–ü—É—Å—Ç—å —ç—Ç–æ—Ç –¥–µ–Ω—å –±—É–¥–µ—Ç –ª—ë–≥–∫–∏–º –∏ –ø—Ä–∏—è—Ç–Ω—ã–º",
            "–ñ–µ–ª–∞—é —Ç–µ–±–µ —Å–µ–≥–æ–¥–Ω—è –Ω–∞–π—Ç–∏ –≥–∞—Ä–º–æ–Ω–∏—é",
            "–ü—É—Å—Ç—å –≤—Å—ë —Å–µ–≥–æ–¥–Ω—è —Å–∫–ª–∞–¥—ã–≤–∞–µ—Ç—Å—è –ø—Ä–µ–∫—Ä–∞—Å–Ω–æ",
            "–°–µ–≥–æ–¥–Ω—è ‚Äî –¥–µ–Ω—å –¥–ª—è –¥–æ–±—Ä—ã—Ö –≤—Å—Ç—Ä–µ—á",
            "–ü—É—Å—Ç—å –∫–∞–∂–¥–∞—è –º–∏–Ω—É—Ç–∞ —Å–µ–≥–æ–¥–Ω—è –±—É–¥–µ—Ç –≤ —Ä–∞–¥–æ—Å—Ç—å",
            "–ñ–µ–ª–∞—é —Ç–µ–±–µ —Å–µ–≥–æ–¥–Ω—è —á—É–≤—Å—Ç–≤–æ–≤–∞—Ç—å —Å–µ–±—è –ª—é–±–∏–º—ã–º",
            "–ü—É—Å—Ç—å —ç—Ç–æ—Ç –¥–µ–Ω—å –±—É–¥–µ—Ç –ø–æ–ª–æ–Ω —Å–º—ã—Å–ª–∞",
            "–°–µ–≥–æ–¥–Ω—è –≤—Å—ë –ø–æ–ª—É—á–∏—Ç—Å—è, –µ—Å–ª–∏ –∑–∞—Ö–æ—Ç–µ—Ç—å",
            "–ü—É—Å—Ç—å –¥–µ–Ω—å –ø—Ä–∏–Ω–µ—Å—ë—Ç —Ç–µ–±–µ —Å–ø–æ–∫–æ–π—Å—Ç–≤–∏–µ",
            "–ñ–µ–ª–∞—é —Ç–µ–±–µ —Å–µ–≥–æ–¥–Ω—è –±–æ–ª—å—à–µ –ø–æ–≤–æ–¥–æ–≤ –¥–ª—è —Å—á–∞—Å—Ç—å—è",
            "–ü—É—Å—Ç—å –≤—Å—ë —Å–µ–≥–æ–¥–Ω—è –∏–¥—ë—Ç –ª–µ–≥–∫–æ –∏ —Ä–∞–¥–æ—Å—Ç–Ω–æ",
            "–°–µ–≥–æ–¥–Ω—è ‚Äî –ø—Ä–µ–∫—Ä–∞—Å–Ω—ã–π –¥–µ–Ω—å, —á—Ç–æ–±—ã —É–ª—ã–±–Ω—É—Ç—å—Å—è",
            "–ü—É—Å—Ç—å —ç—Ç–æ—Ç –¥–µ–Ω—å –±—É–¥–µ—Ç –¥–æ–±—Ä—ã–º –∏ —Å–æ–ª–Ω–µ—á–Ω—ã–º",
            "–ñ–µ–ª–∞—é —Ç–µ–±–µ —Å–µ–≥–æ–¥–Ω—è —Ç–µ–ø–ª–∞ –∏ —É—é—Ç–∞ –≤ —Å–µ—Ä–¥—Ü–µ",
            "–ü—É—Å—Ç—å –≤—Å—ë —Å–µ–≥–æ–¥–Ω—è –ø—Ä–∏–Ω–æ—Å–∏—Ç —Ä–∞–¥–æ—Å—Ç—å",
            "–°–µ–≥–æ–¥–Ω—è ‚Äî –¥–µ–Ω—å –¥–ª—è —Ö–æ—Ä–æ—à–µ–≥–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è",
            "–ü—É—Å—Ç—å –∫–∞–∂–¥—ã–π –º–æ–º–µ–Ω—Ç —Å–µ–≥–æ–¥–Ω—è –±—É–¥–µ—Ç —Ü–µ–Ω–µ–Ω"
        ]
        
        # –°–µ–º–µ–π–Ω—ã–µ —Ç—Ä–∞–¥–∏—Ü–∏–∏
        self.recurring_events = {
            'tarelka': {
                'name': '–°–µ–º–µ–π–Ω–∞—è —Ç—Ä–∞–¥–∏—Ü–∏—è - –ü—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ –Ω–∞ —Ç–∞—Ä–µ–ª–∫–µ', 
                'file': 'tarelka.txt', 
                'rule': 'last_saturday'
            },
            'chronos': {
                'name': '–°–µ–º–µ–π–Ω–∞—è —Ç—Ä–∞–¥–∏—Ü–∏—è - –í–µ—á–µ—Ä –≤–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏–π. –•—Ä–∞–Ω–∏—Ç–µ–ª–∏ –≤—Ä–µ–º–µ–Ω–∏', 
                'file': 'chronos.txt', 
                'rule': 'third_saturday'
            },
            'new': {
                'name': '–°–µ–º–µ–π–Ω–∞—è —Ç—Ä–∞–¥–∏—Ü–∏—è - –î–µ–Ω—å –Ω–æ–≤–æ–≥–æ', 
                'file': 'new.txt', 
                'rule': 'second_saturday'
            }
        }
        
        # –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –∑–∞–Ω—è—Ç–∏–π –¥–µ—Ç–µ–π
        self.kids_schedule = {
            '–ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫': [
                {'child': 'üëß –ú–∞—Ä—Ç–∞', 'activity': 'üá¨üáß –ê–Ω–≥–ª–∏–π—Å–∫–∏–π', 'time': '16:00-17:00'},
                {'child': 'üë¶ –ê—Ä–∫–∞—à–∞', 'activity': 'üìê –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞', 'time': '19:00-20:00'}
            ],
            '–≤—Ç–æ—Ä–Ω–∏–∫': [
                {'child': 'üëß –ú–∞—Ä—Ç–∞', 'activity': 'üíÉ –¢–∞–Ω—Ü—ã', 'time': '17:30-19:00'},
                {'child': 'üë¶ –ê—Ä–∫–∞—à–∞', 'activity': '‚öΩ –§—É—Ç–±–æ–ª', 'time': '17:00-18:00'}
            ],
            '—Å—Ä–µ–¥–∞': [
                {'child': 'üëß –ú–∞—Ä—Ç–∞', 'activity': 'ü§∫ –§–µ—Ö—Ç–æ–≤–∞–Ω–∏–µ', 'time': '15:00-16:30'},
                {'child': 'üë¶ –ê—Ä–∫–∞—à–∞', 'activity': 'ü§∫ –§–µ—Ö—Ç–æ–≤–∞–Ω–∏–µ', 'time': '16:00-18:00'},
                {'child': 'üëß –ú–∞—Ä—Ç–∞', 'activity': 'üá¨üáß –ê–Ω–≥–ª–∏–π—Å–∫–∏–π', 'time': '17:00-18:00'}
            ],
            '—á–µ—Ç–≤–µ—Ä–≥': [
                {'child': 'üëß –ú–∞—Ä—Ç–∞', 'activity': 'üíÉ –¢–∞–Ω—Ü—ã', 'time': '17:30-19:00'},
                {'child': 'üë¶ –ê—Ä–∫–∞—à–∞', 'activity': '‚öΩ –§—É—Ç–±–æ–ª', 'time': '17:00-18:00'}
            ],
            '–ø—è—Ç–Ω–∏—Ü–∞': [
                {'child': 'üëß –ú–∞—Ä—Ç–∞', 'activity': 'ü§∫ –§–µ—Ö—Ç–æ–≤–∞–Ω–∏–µ', 'time': '15:00-16:30'},
                {'child': 'üë¶ –ê—Ä–∫–∞—à–∞', 'activity': 'ü§∫ –§–µ—Ö—Ç–æ–≤–∞–Ω–∏–µ', 'time': '16:00-18:00'},
                {'child': 'üë¶ –ê—Ä–∫–∞—à–∞', 'activity': 'üìê –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞', 'time': '19:00-20:00'}
            ],
            '—Å—É–±–±–æ—Ç–∞': [
                {'child': 'üëß –ú–∞—Ä—Ç–∞', 'activity': 'ü§∫ –§–µ—Ö—Ç–æ–≤–∞–Ω–∏–µ', 'time': '15:00-17:00'}
            ],
            '–≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ': [
                {'child': 'üëß –ú–∞—Ä—Ç–∞', 'activity': 'ü§∫ –§–µ—Ö—Ç–æ–≤–∞–Ω–∏–µ', 'time': '12:00-14:00'},
                {'child': 'üë¶ –ê—Ä–∫–∞—à–∞', 'activity': 'ü§∫ –§–µ—Ö—Ç–æ–≤–∞–Ω–∏–µ', 'time': '14:00-16:00'}
            ]
        }
        
        # –ö—Ç–æ –º–æ–µ—Ç –ø–æ—Å—É–¥—É
        self.dishes_schedule = {
            '–ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫': 'üëß –ú–∞—Ä—Ç–∞ –º–æ–µ—Ç –ø–æ—Å—É–¥—É',
            '–≤—Ç–æ—Ä–Ω–∏–∫': 'üë¶ –ê—Ä–∫–∞—à–∞ –º–æ–µ—Ç –ø–æ—Å—É–¥—É',
            '—Å—Ä–µ–¥–∞': 'üëß –ú–∞—Ä—Ç–∞ –º–æ–µ—Ç –ø–æ—Å—É–¥—É',
            '—á–µ—Ç–≤–µ—Ä–≥': 'üë¶ –ê—Ä–∫–∞—à–∞ –º–æ–µ—Ç –ø–æ—Å—É–¥—É',
            '–ø—è—Ç–Ω–∏—Ü–∞': 'üëß –ú–∞—Ä—Ç–∞ –º–æ–µ—Ç –ø–æ—Å—É–¥—É',
            '—Å—É–±–±–æ—Ç–∞': 'üë®‚Äçüë©‚Äçüëß‚Äçüë¶ –†–æ–¥–∏—Ç–µ–ª–∏ –º–æ—é—Ç –ø–æ—Å—É–¥—É',
            '–≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ': 'üë®‚Äçüë©‚Äçüëß‚Äçüë¶ –†–æ–¥–∏—Ç–µ–ª–∏ –º–æ—é—Ç –ø–æ—Å—É–¥—É'
        }

    def get_random_wisdom(self):
        return random.choice(self.wisdoms)

    def get_today_schedule(self):
        now = datetime.now()
        date_str = now.strftime("%d.%m.%Y")
        day_of_week = now.strftime("%A").lower()
        return date_str, day_of_week

    async def get_weather_forecast(self):
        """–ü–æ–ª—É—á–∞–µ—Ç –ø—Ä–æ–≥–Ω–æ–∑ –ø–æ–≥–æ–¥—ã –¥–ª—è –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥–∞"""
        try:
            async with aiohttp.ClientSession() as session:
                async with session.get(
                    "https://wttr.in/Saint-Petersburg?format=%t+%C+%w+%h+%p&m&lang=ru", 
                    timeout=10
                ) as response:
                    if response.status == 200:
                        weather_data = await response.text()
                        parts = weather_data.strip().split()
                        if len(parts) >= 5:
                            temp, condition, wind, humidity, precipitation = parts[:5]
                            return (
                                f"üå§Ô∏è <b>–ü–æ–≥–æ–¥–∞ –≤ –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥–µ:</b>\n"
                                f"üå°Ô∏è –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞: {temp}\n"
                                f"‚òÅÔ∏è –°–æ—Å—Ç–æ—è–Ω–∏–µ: {condition}\n"
                                f"üí® –í–µ—Ç–µ—Ä: {wind}\n"
                                f"üíß –í–ª–∞–∂–Ω–æ—Å—Ç—å: {humidity}\n"
                                f"üåßÔ∏è –û—Å–∞–¥–∫–∏: {precipitation}\n"
                            )
                        return "üå§Ô∏è <b>–ü–æ–≥–æ–¥–∞:</b> –î–∞–Ω–Ω—ã–µ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã\n"
                    return "üå§Ô∏è <b>–ü–æ–≥–æ–¥–∞:</b> –û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è\n"
        except Exception as e:
            logger.error(f"‚ùå –û—à–∏–±–∫–∞ –ø–æ–≥–æ–¥—ã: {e}")
            return "üå§Ô∏è <b>–ü–æ–≥–æ–¥–∞:</b> –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è\n"

    def get_last_day_of_month(self, year, month, target_weekday):
        """–ü–æ–ª—É—á–∞–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–π –¥–µ–Ω—å –º–µ—Å—è—Ü–∞ –¥–ª—è –∑–∞–¥–∞–Ω–Ω–æ–≥–æ –¥–Ω—è –Ω–µ–¥–µ–ª–∏"""
        calendar = monthcalendar(year, month)
        for week in reversed(calendar):
            day = week[target_weekday]
            if day != 0:
                return day
        return None

    def get_event_date_by_rule(self, rule, year, month):
        """–ü–æ–ª—É—á–∞–µ—Ç –¥–∞—Ç—É —Å–æ–±—ã—Ç–∏—è –ø–æ –ø—Ä–∞–≤–∏–ª—É"""
        if rule == 'last_saturday':
            day = self.get_last_day_of_month(year, month, 5)
            return (year, month, day) if day else None
        elif rule == 'third_saturday':
            calendar = monthcalendar(year, month)
            saturdays = [week[5] for week in calendar if week[5] != 0]
            if len(saturdays) >= 3:
                return (year, month, saturdays[2])
        elif rule == 'second_saturday':
            calendar = monthcalendar(year, month)
            saturdays = [week[5] for week in calendar if week[5] != 0]
            if len(saturdays) >= 2:
                return (year, month, saturdays[1])
        return None

    def check_recurring_events(self):
        """–ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–µ–º–µ–π–Ω—ã–µ —Ç—Ä–∞–¥–∏—Ü–∏–∏ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è"""
        from datetime import date as dt
        today = datetime.now()
        year, month, day = today.year, today.month, today.day
        reminders = []
        
        for event_key, event in self.recurring_events.items():
            event_date = self.get_event_date_by_rule(event['rule'], year, month)
            if not event_date:
                continue
                
            event_year, event_month, event_day = event_date
            event_dt = dt(event_year, event_month, event_day)
            today_dt = dt(year, month, day)
            days_until = (event_dt - today_dt).days
            
            if days_until == 7:
                reminders.append({'key': event_key, 'event': event, 'type': 'week_before'})
            elif days_until == 3:
                reminders.append({'key': event_key, 'event': event, 'type': 'three_days_before'})
            elif days_until == 0:
                reminders.append({'key': event_key, 'event': event, 'type': 'event_day'})
        
        return reminders

    async def fetch_event_file(self, filename):
        """–ó–∞–≥—Ä—É–∂–∞–µ—Ç —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º —Ç—Ä–∞–¥–∏—Ü–∏–∏"""
        try:
            url = f"https://raw.githubusercontent.com/BRKME/Day/main/{filename}"
            async with aiohttp.ClientSession() as session:
                async with session.get(url, timeout=10) as response:
                    if response.status == 200:
                        content = await response.text()
                        logger.info(f"‚úÖ –§–∞–π–ª {filename} –∑–∞–≥—Ä—É–∂–µ–Ω")
                        return content
                    else:
                        logger.error(f"‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ {filename}")
                        return None
        except Exception as e:
            logger.error(f"‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ {filename}: {e}")
            return None

    def get_kids_schedule(self, day_of_week):
        """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –¥–µ—Ç–µ–π –Ω–∞ —Å–µ–≥–æ–¥–Ω—è"""
        logger.info(f"üìÖ –ó–∞–ø—Ä–æ—Å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è –¥–µ—Ç–µ–π –¥–ª—è –¥–Ω—è: {day_of_week}")
        
        if not day_of_week:
            logger.warning("‚ö†Ô∏è day_of_week is None or empty")
            return None
        
        day_ru = self.DAY_NAMES_MAP.get(day_of_week)
        if not day_ru:
            logger.warning(f"‚ö†Ô∏è –î–µ–Ω—å '{day_of_week}' –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –º–∞–ø–ø–∏–Ω–≥–µ")
            return None
        
        if day_ru not in self.kids_schedule:
            logger.warning(f"‚ö†Ô∏è –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –¥–ª—è –¥–Ω—è '{day_ru}' –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç")
            return None
        
        activities = self.kids_schedule[day_ru]
        
        if not activities:
            logger.info(f"‚ÑπÔ∏è –ù–µ—Ç –∑–∞–Ω—è—Ç–∏–π –Ω–∞ {day_ru}")
            return None
        
        logger.info(f"‚úÖ –ù–∞–π–¥–µ–Ω–æ {len(activities)} –∑–∞–Ω—è—Ç–∏–π –¥–ª—è {day_ru}")
        
        schedule_text = "<b>üë®‚Äçüë©‚Äçüëß‚Äçüë¶ –ó–∞–Ω—è—Ç–∏—è –¥–µ—Ç–µ–π —Å–µ–≥–æ–¥–Ω—è:</b>\n"
        successful_items = 0
        
        for idx, item in enumerate(activities):
            try:
                child = item['child']
                activity = item['activity']
                time = item['time']
                
                schedule_text += f"‚Ä¢ {child} ‚Äî {activity} <i>({time})</i>\n"
                successful_items += 1
                logger.debug(f"  ‚úì –ó–∞–Ω—è—Ç–∏–µ {idx+1}: {child} - {activity} ({time})")
                
            except KeyError as e:
                logger.error(f"‚ùå –û—à–∏–±–∫–∞ –≤ –¥–∞–Ω–Ω—ã—Ö —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è (—ç–ª–µ–º–µ–Ω—Ç {idx+1}): –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∫–ª—é—á {e}")
                continue
            except Exception as e:
                logger.error(f"‚ùå –ù–µ–æ–∂–∏–¥–∞–Ω–Ω–∞—è –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ —ç–ª–µ–º–µ–Ω—Ç–∞ {idx+1}: {e}")
                continue
        
        if successful_items == 0:
            logger.warning(f"‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∏ –æ–¥–Ω–æ–≥–æ –∑–∞–Ω—è—Ç–∏—è –¥–ª—è {day_ru}")
            return None
        
        logger.info(f"‚úÖ –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–æ: {successful_items}/{len(activities)} –∑–∞–Ω—è—Ç–∏–π")
        return schedule_text

    def get_dishes_reminder(self, day_of_week):
        """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –∫—Ç–æ –º–æ–µ—Ç –ø–æ—Å—É–¥—É"""
        day_ru = self.DAY_NAMES_MAP.get(day_of_week)
        if not day_ru:
            return None
        
        return self.dishes_schedule.get(day_ru)

    async def format_morning_message(self, date_str, day_of_week):
        """–§–æ—Ä–º–∏—Ä—É–µ—Ç —É—Ç—Ä–µ–Ω–Ω–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ"""
        day_names = {
            'monday': '–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫', 
            'tuesday': '–í—Ç–æ—Ä–Ω–∏–∫', 
            'wednesday': '–°—Ä–µ–¥–∞', 
            'thursday': '–ß–µ—Ç–≤–µ—Ä–≥', 
            'friday': '–ü—è—Ç–Ω–∏—Ü–∞', 
            'saturday': '–°—É–±–±–æ—Ç–∞', 
            'sunday': '–í–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ'
        }
        day_ru = day_names.get(day_of_week, day_of_week)
        wisdom = self.get_random_wisdom()
        
        content = f"üåÖ <b>–î–æ–±—Ä–æ–µ —É—Ç—Ä–æ! {day_ru}, {date_str}</b>\n\n"
        
        # –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–≥–æ–¥—É
        weather = await self.get_weather_forecast()
        content += weather + "\n"
        
        content += f"üí≠ {wisdom}\n\n"
        
        # –î–æ–±–∞–≤–ª—è–µ–º —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –¥–µ—Ç–µ–π
        kids_schedule_text = self.get_kids_schedule(day_of_week)
        if kids_schedule_text:
            content += f"{kids_schedule_text}\n"
        
        # –î–æ–±–∞–≤–ª—è–µ–º –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –∫—Ç–æ –º–æ–µ—Ç –ø–æ—Å—É–¥—É
        dishes_reminder = self.get_dishes_reminder(day_of_week)
        if dishes_reminder:
            content += f"<b>üçΩÔ∏è –ü–æ—Å—É–¥–∞:</b>\n‚Ä¢ {dishes_reminder}\n\n"
        
        # –î–æ–±–∞–≤–ª—è–µ–º –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –ø—Ä–æ —É–±–æ—Ä–∫—É –≤ –ø—è—Ç–Ω–∏—Ü—É
        if day_of_week == 'friday':
            content += "<b>üßπ –°–µ–≥–æ–¥–Ω—è –ø—è—Ç–Ω–∏—Ü–∞:</b>\n‚Ä¢ –ó–∞—á—ë—Ç –ø–æ —á–∏—Å—Ç–æ—Ç–µ –∫–æ–º–Ω–∞—Ç—ã <i>(20 min)</i>\n\n"
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–µ–º–µ–π–Ω—ã–µ —Ç—Ä–∞–¥–∏—Ü–∏–∏
        reminders = self.check_recurring_events()
        if reminders:
            for reminder in reminders:
                event = reminder['event']
                event_content = await self.fetch_event_file(event['file'])
                
                if reminder['type'] == 'week_before':
                    content += f"\nüîî <b>–ù–ê–ü–û–ú–ò–ù–ê–ù–ò–ï (–ó–∞ 7 –¥–Ω–µ–π):</b>\n<b>{event['name']}</b>\n"
                    if event_content:
                        content += f"{event_content}\n"
                elif reminder['type'] == 'three_days_before':
                    content += f"\nüîî <b>–ù–ê–ü–û–ú–ò–ù–ê–ù–ò–ï (–ó–∞ 3 –¥–Ω—è):</b>\n<b>{event['name']}</b>\n"
                    if event_content:
                        content += f"{event_content}\n"
                elif reminder['type'] == 'event_day':
                    content += f"\nüéâ <b>–°–ï–ì–û–î–ù–Ø:</b>\n<b>{event['name']}</b>\n"
                    if event_content:
                        content += f"{event_content}\n"
        
        return content

    async def send_telegram_message(self, message, send_ss=False):
        """–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ Telegram"""
        try:
            url = f"https://api.telegram.org/bot{self.telegram_token}/sendMessage"
            payload = {
                'chat_id': self.chat_id, 
                'text': message, 
                'parse_mode': 'HTML',
                'disable_web_page_preview': False
            }
            
            logger.info("üì§ –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ Telegram...")
            async with aiohttp.ClientSession() as session:
                async with session.post(url, json=payload, timeout=10) as response:
                    if response.status != 200:
                        error_text = await response.text()
                        logger.error(f"‚ùå –û—à–∏–±–∫–∞ API {response.status}: {error_text}")
                        return False
            
            # –ï—Å–ª–∏ –≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ - –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å—Å—ã–ª–∫—É –Ω–∞ —Å–µ–º–µ–π–Ω—ã–π —Å–æ–≤–µ—Ç
            if send_ss:
                family_msg = f"<b>üìã –°–µ–º–µ–π–Ω—ã–π —Å–æ–≤–µ—Ç:</b>\n\nüîó <a href='{self.ss_url}'>–û—Ç–∫—Ä—ã—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –°–µ–º–µ–π–Ω–æ–≥–æ –°–æ–≤–µ—Ç–∞</a>"
                payload_council = {
                    'chat_id': self.chat_id, 
                    'text': family_msg, 
                    'parse_mode': 'HTML', 
                    'disable_web_page_preview': False
                }
                async with aiohttp.ClientSession() as session:
                    async with session.post(url, json=payload_council, timeout=10) as response:
                        if response.status == 200:
                            logger.info("‚úÖ –°–æ–æ–±—â–µ–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã!")
                            return True
                        else:
                            error_text = await response.text()
                            logger.error(f"‚ùå –û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–µ–º–µ–π–Ω–æ–≥–æ —Å–æ–≤–µ—Ç–∞ {response.status}: {error_text}")
                            return False
            else:
                logger.info("‚úÖ –°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ!")
                return True
                
        except Exception as e:
            logger.error(f"‚ùå –û—à–∏–±–∫–∞: {e}")
            return False

    async def send_morning_message(self):
        """–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É—Ç—Ä–µ–Ω–Ω–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ"""
        date_str, day_of_week = self.get_today_schedule()
        message = await self.format_morning_message(date_str, day_of_week)
        
        # –ï—Å–ª–∏ –≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ - –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–µ–º–µ–π–Ω—ã–π —Å–æ–≤–µ—Ç
        send_ss = (day_of_week == 'sunday')
        
        return await self.send_telegram_message(message, send_ss=send_ss)

async def main():
    logger.info(f"üöÄ –ó–∞–ø—É—Å–∫ —Å–µ–º–µ–π–Ω–æ–≥–æ –±–æ—Ç–∞")
    bot = FamilyScheduleBot()
    success = await bot.send_morning_message()
    if success:
        logger.info("üéâ –£—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω–æ!")
    else:
        logger.error("üí• –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ")
        sys.exit(1)

if __name__ == "__main__":
    asyncio.run(main())
